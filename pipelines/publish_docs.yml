# specific path build
trigger:
  branches:
    include:
    - main
  paths:
    include:
    - docs
    - mkdocs.yml

pool:
  vmImage: ubuntu-latest

resources:
  repositories:
    - repository: 'self'
      type: 'github'
      endpoint: 'Mauwii'
      name: 'mauwii/django_devops'

steps:

  - checkout: self
    submodules: 'true'
    persistCredentials: 'true'

  - task: UsePythonVersion@0
    displayName: 'Use Python 3.9.x'
    inputs:
      versionSpec: '3.9'
      addToPath: true
      architecture: 'x64'
  
  - task: Bash@3
    displayName: 'Install MkDocs'
    inputs:
      targetType: 'inline'
      script: 'pip install -e mkdocs-material'
  
  - task: Bash@3
    displayName: 'Build mkdocs'
    inputs:
      targetType: 'inline'
      script: 'mkdocs build'

  - task: Bash@3
    displayName: 'Deploy to GitHub-Pages'
    inputs:
      targetType: 'inline'
      script: 'mkdocs gh-deploy --force --clean'
