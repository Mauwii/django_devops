parameters:
  - name: PYTHON_VERSION
    type: string
    default: $(pythonVersion)
  - name: publishBuildArtifact
    type: boolean
    default: False

steps:
  - task: UsePythonVersion@0
    displayName: 'Use Python ${{ parameters.PYTHON_VERSION }}'
    inputs:
      versionSpec: ${{ parameters.PYTHON_VERSION }}
      addToPath: true
      architecture: 'x64'

  - script: |
      python -m venv antenv
      source antenv/bin/activate
      python -m pip install --upgrade pip wheel setuptools
      pip install setup
      pip install -r requirements.txt
    workingDirectory: $(projectRoot)
    displayName: 'Install Requirements'

  - task: PublishPipelineArtifact@1
    condition: or(eq(variables.isProduction, 'True'), eq(${{ parameters.publishBuildArtifact }}, 'True'))
    inputs:
      targetPath: $(projectRoot)
      # targetPath: $(System.DefaultWorkingDirectory)/bin/WebApp
      artifactName: WebApp
