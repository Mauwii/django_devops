# Pipeline Template to build MkDocs
parameters:
  - name: pythonVersion
    type: string
    default: $(pythonVersion)
  - name: mkdocs_site_dir
    type: string
    default: 'site'
  - name: mkdocs_deploy
    type: boolean
    default: false

steps:
  - task: UsePythonVersion@0
    displayName: 'Use Python ${{ parameters.pythonVersion }}'
    inputs:
      versionSpec: '${{ parameters.pythonVersion }}'
      addToPath: true
      architecture: x64

  - script: pip install --upgrade pip wheel setuptools
    displayName: update tools

  - script: pip install -e src/mkdocs-material
    displayName: install MkDocs-Material

  - script: pip install -r src/requirements-mkdocs-material.txt
    displayName: install requirements

  - script: mkdocs build --site-dir ${{ parameters.mkdocs_site_dir }} --verbose
    displayName: build docs

  - ${{ if eq(parameters.mkdocs_deploy, 'true') }}:
      - script: mkdocs gh-deploy --force --site-dir ${{ parameters.mkdocs_site_dir }} --verbose
        displayName: deploy to GitHub-Pages
